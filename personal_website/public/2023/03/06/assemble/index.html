<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 5.4.2">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha256-/4UQcSmErDzPCMAiuOiWPVVsNN2s3ZY/NsmXNcj0IFc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.15.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="前言：前前后后看完这本书，做完所有实验和检测点，用了接近一个月的时间，除了最后几天比较认真，其余时间是比较懒散的，这本书其实最多半个月就能解决掉。接下来会步入CSAPP第三章的学习，争取早日把有名的attack lab完成了">
<meta property="og:type" content="article">
<meta property="og:title" content="assembly language">
<meta property="og:url" content="http://example.com/2023/03/06/assemble/index.html">
<meta property="og:site_name" content="Elite-X">
<meta property="og:description" content="前言：前前后后看完这本书，做完所有实验和检测点，用了接近一个月的时间，除了最后几天比较认真，其余时间是比较懒散的，这本书其实最多半个月就能解决掉。接下来会步入CSAPP第三章的学习，争取早日把有名的attack lab完成了">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673249473372-3a80b2ab-d9e2-483c-ac41-140d30fdd765.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673249669344-d36231e5-8310-46ba-a3c6-155e2601ff58.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673250172971-61fbb876-feda-4ca9-b81d-e558cc0e5a6a.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673250237721-ec3e62f5-f6bc-4890-8f25-b62f6d89e60e.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673250558182-3582fd8d-9783-421c-9731-0d83ae5c81a8.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673251622812-ca79ef23-5a2a-46b2-ba9f-326aa9d3bc54.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673251941938-25cdf39e-5c26-49a3-81da-f108dff28da7.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673253290191-823908a7-61e0-4e4d-ac20-66184b8a4509.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673596808599-b129a717-4d20-42a3-8823-64dc726440e3.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673596896692-f6335ebe-e9b7-44cf-9a38-d686dde7d140.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673597028389-791ccf84-0268-4f23-976f-53e6ecd97b36.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673681789903-cb9f13be-b044-4c3f-be1d-8fa401195306.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673682350829-98451696-0d75-4414-87c5-b527b5c96169.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673682565168-917f19d2-8e0c-44ab-84e5-453c301bcda0.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673682886059-386e1af8-2b73-480f-92b1-d2ea01cce40a.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673769654198-dcf5a11b-b298-4d67-ac52-e6412baa7953.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673770040980-f6175097-5e41-41f0-a0d4-ed6dcc9e2d26.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673770269260-0b535c86-7318-4bea-9b9b-151df8786503.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673771416582-e853218d-46c6-4bf8-98d6-cacae4200dbb.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673774640766-de55642e-4594-4add-9f75-ac17f9cf3628.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673877104816-d24fcee5-293b-4965-a116-55b74e84812c.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673877337524-5a528fcf-a7ec-47a7-ba04-6014616d76ff.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673877858110-72e7472f-1574-4c88-ae28-a064f40894e4.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673878358257-7f67627a-48a8-45cf-bc4a-1f51e9552faa.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673879121558-74eaedb2-acd9-4a9c-a318-e028bba49db2.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673882442409-a3ef513e-eb43-4f18-abf5-ea6f262cc3f6.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673882790995-352f2b4b-203d-458a-b5a2-878acfd29335.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673885232599-a5e6bf92-ae97-421b-ad5b-904f427aef76.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673885271367-eddf0cc8-98aa-4fe8-a38f-a014ed5f8179.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673954476992-988989f0-7ba5-4132-8b53-011e5cfe1ce7.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673954644257-b63d5af0-f266-4057-b1e1-c513e09c9298.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673955793129-198d15a6-56f1-4375-a4c1-fa6d84e6aa7c.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673955864652-707fd6d7-d65d-4be6-b3f9-bbcbbc27484b.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1674054412418-905eb553-63b9-4352-8fd3-87d9c57ec955.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1674054465034-493bafb1-d935-4da9-b3d0-07b0bdd54911.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1674306714709-54439679-a96b-496d-97b1-de0f2c3abf77.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1674447541217-19494cef-6da4-4fd3-b28c-6ad18c755471.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1674959885930-a6c4181a-e6a1-44cb-9ec8-cc5013b1314e.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675050216892-a6c856a5-19e3-42a9-9dae-62052e8d077c.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675070403817-35e5aa0f-3d0c-42ab-803a-9d7dbf5bcb8a.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675142887049-1e6b7958-8779-4745-81f5-c6a536a232ca.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675159533550-89caf027-f6da-4345-aa8c-e03159df600e.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675224733068-a783d5cd-5d35-46b5-8032-3c8938e8347a.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675237825483-f1ed3d6d-00cc-453b-91b3-757823355468.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675253920788-8fc4fee5-abeb-4e49-93bf-97e3873b6599.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675319548168-77f7b5a6-54bb-4526-b234-adb0e561004e.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675322759364-2785ad21-17c7-4499-b1a3-fe6726975b02.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675329053483-60588212-d9b5-4cef-acf7-06c70f65db5f.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675411618416-c6c100a2-f4d1-4bc9-b3e6-22f83fcdcaee.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675431818731-db0edf92-bc54-4bfc-a35f-613c796dddda.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675343108877-68cf68d3-97ef-4ecb-8b4f-6da330149c94.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675341791119-4c9029f0-b9e3-4e2f-b1b9-aa5d02685f8f.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675409971871-70ff728a-fa74-48ac-a742-be8ec319d677.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675409382345-20e1a2f2-8973-4150-992a-2a8acb141fa9.png">
<meta property="article:published_time" content="2023-03-06T05:00:00.000Z">
<meta property="article:modified_time" content="2023-03-08T07:17:44.176Z">
<meta property="article:author" content="Elite-X">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673249473372-3a80b2ab-d9e2-483c-ac41-140d30fdd765.png">


<link rel="canonical" href="http://example.com/2023/03/06/assemble/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2023/03/06/assemble/","path":"2023/03/06/assemble/","title":"assembly language"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>assembly language | Elite-X</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Elite-X</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">前言：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">1.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C1-%E6%9F%A5%E7%9C%8BCPU%E5%92%8C%E5%86%85%E5%AD%98%EF%BC%8C%E7%94%A8%E6%9C%BA%E5%99%A8%E6%8C%87%E4%BB%A4%E5%92%8C%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E7%BC%96%E7%A8%8B"><span class="nav-number">2.</span> <span class="nav-text">实验1 查看CPU和内存，用机器指令和汇编指令编程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#debug%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%EF%BC%9A%E5%8F%82%E8%80%83%E6%AD%A4%E6%96%87"><span class="nav-number">2.1.</span> <span class="nav-text">debug环境搭建：参考此文</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-1"><span class="nav-number">2.2.</span> <span class="nav-text">assignment 1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-2"><span class="nav-number">2.3.</span> <span class="nav-text">assignment 2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-3"><span class="nav-number">2.4.</span> <span class="nav-text">assignment 3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-4"><span class="nav-number">2.5.</span> <span class="nav-text">assignment 4</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C2-%E7%94%A8%E6%9C%BA%E5%99%A8%E6%8C%87%E4%BB%A4%E5%92%8C%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E7%BC%96%E7%A8%8B"><span class="nav-number">3.</span> <span class="nav-text">实验2 用机器指令和汇编指令编程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-1-1"><span class="nav-number">3.1.</span> <span class="nav-text">assignment 1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-2-1"><span class="nav-number">3.2.</span> <span class="nav-text">assignment 2</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C3-%E7%BC%96%E7%A8%8B%E3%80%81%E7%BC%96%E8%AF%91%E3%80%81%E9%93%BE%E6%8E%A5%E3%80%81%E8%B7%9F%E8%B8%AA"><span class="nav-number">4.</span> <span class="nav-text">实验3 编程、编译、链接、跟踪</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-1-2"><span class="nav-number">4.1.</span> <span class="nav-text">assignment 1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-2-2"><span class="nav-number">4.2.</span> <span class="nav-text">assignment 2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-3-1"><span class="nav-number">4.3.</span> <span class="nav-text">assignment 3</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C4-bx-%E5%92%8Cloop%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">5.</span> <span class="nav-text">实验4 [bx]和loop的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-1-3"><span class="nav-number">5.1.</span> <span class="nav-text">assignment 1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-2-3"><span class="nav-number">5.2.</span> <span class="nav-text">assignment 2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-3-2"><span class="nav-number">5.3.</span> <span class="nav-text">assignment 3</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C5-%E7%BC%96%E5%86%99%E3%80%81%E8%B0%83%E8%AF%95%E5%85%B7%E6%9C%89%E5%A4%9A%E4%B8%AA%E6%AE%B5%E7%9A%84%E7%A8%8B%E5%BA%8F"><span class="nav-number">6.</span> <span class="nav-text">实验5 编写、调试具有多个段的程序</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-1-4"><span class="nav-number">6.1.</span> <span class="nav-text">assignment 1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-2-4"><span class="nav-number">6.2.</span> <span class="nav-text">assignment 2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-3-3"><span class="nav-number">6.3.</span> <span class="nav-text">assignment 3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-4-1"><span class="nav-number">6.4.</span> <span class="nav-text">assignment 4</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-5"><span class="nav-number">6.5.</span> <span class="nav-text">assignment 5</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-6"><span class="nav-number">6.6.</span> <span class="nav-text">assignment 6</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C6-%E5%AE%9E%E8%B7%B5%E8%AF%BE%E7%A8%8B%E4%B8%AD%E7%9A%84%E7%A8%8B%E5%BA%8F"><span class="nav-number">7.</span> <span class="nav-text">实验6 实践课程中的程序</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-1-5"><span class="nav-number">7.1.</span> <span class="nav-text">assignment 1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-2-5"><span class="nav-number">7.2.</span> <span class="nav-text">assignment 2</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C7-%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F%E5%9C%A8%E7%BB%93%E6%9E%84%E5%8C%96%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-number">8.</span> <span class="nav-text">实验7 寻址方式在结构化数据访问中的应用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C8-%E5%88%86%E6%9E%90%E4%B8%80%E4%B8%AA%E5%A5%87%E6%80%AA%E7%9A%84%E7%A8%8B%E5%BA%8F"><span class="nav-number">9.</span> <span class="nav-text">实验8 分析一个奇怪的程序</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C9-%E6%A0%B9%E6%8D%AE%E6%9D%90%E6%96%99%E7%BC%96%E7%A8%8B"><span class="nav-number">10.</span> <span class="nav-text">实验9 根据材料编程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C10-%E7%BC%96%E5%86%99%E5%AD%90%E7%A8%8B%E5%BA%8F"><span class="nav-number">11.</span> <span class="nav-text">实验10 编写子程序</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-1-6"><span class="nav-number">11.1.</span> <span class="nav-text">assignment 1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-2-6"><span class="nav-number">11.2.</span> <span class="nav-text">assignment 2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-3-4"><span class="nav-number">11.3.</span> <span class="nav-text">assignment 3</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C11-%E7%BC%96%E5%86%99%E5%AD%90%E7%A8%8B%E5%BA%8F"><span class="nav-number">12.</span> <span class="nav-text">实验11 编写子程序</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C12-%E7%BC%96%E5%86%990%E5%8F%B7%E4%B8%AD%E6%96%AD%E7%9A%84%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="nav-number">13.</span> <span class="nav-text">实验12 编写0号中断的处理程序</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C13-%E7%BC%96%E5%86%99%E3%80%81%E5%BA%94%E7%94%A8%E4%B8%AD%E6%96%AD%E4%BE%8B%E7%A8%8B"><span class="nav-number">14.</span> <span class="nav-text">实验13 编写、应用中断例程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-1-7"><span class="nav-number">14.1.</span> <span class="nav-text">assignment 1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-2-7"><span class="nav-number">14.2.</span> <span class="nav-text">assignment 2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-3-5"><span class="nav-number">14.3.</span> <span class="nav-text">assignment 3</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C14-%E8%AE%BF%E9%97%AE-CMOS-RAM"><span class="nav-number">15.</span> <span class="nav-text">实验14 访问 CMOS RAM</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C15-%E5%AE%89%E8%A3%85%E6%96%B0%E7%9A%84int-9-%E4%B8%AD%E6%96%AD%E4%BE%8B%E7%A8%8B"><span class="nav-number">16.</span> <span class="nav-text">实验15 安装新的int 9 中断例程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%BB%83%E4%B9%A01"><span class="nav-number">16.1.</span> <span class="nav-text">前置练习1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%BB%83%E4%B9%A02"><span class="nav-number">16.2.</span> <span class="nav-text">前置练习2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assignment-1-8"><span class="nav-number">16.3.</span> <span class="nav-text">assignment 1</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C16-%E7%BC%96%E5%86%99%E5%8C%85%E5%90%AB%E5%A4%9A%E4%B8%AA%E5%8A%9F%E8%83%BD%E5%AD%90%E7%A8%8B%E5%BA%8F%E7%9A%84%E4%B8%AD%E6%96%AD%E4%BE%8B%E7%A8%8B"><span class="nav-number">17.</span> <span class="nav-text">实验16 编写包含多个功能子程序的中断例程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C17-%E7%BC%96%E5%86%99%E5%8C%85%E5%90%AB%E5%A4%9A%E4%B8%AA%E5%8A%9F%E8%83%BD%E5%AD%90%E7%A8%8B%E5%BA%8F%E7%9A%84%E4%B8%AD%E6%96%AD%E4%BE%8B%E7%A8%8B"><span class="nav-number">18.</span> <span class="nav-text">实验17 编写包含多个功能子程序的中断例程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%83%E4%B9%A017-1"><span class="nav-number">18.1.</span> <span class="nav-text">练习17-1</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Other"><span class="nav-number">19.</span> <span class="nav-text">Other</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E7%90%86%E8%A7%A3assume%E4%BC%AA%E6%8C%87%E4%BB%A4%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">19.1.</span> <span class="nav-text">1. 理解assume伪指令的作用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E7%90%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E6%A0%87%E5%8F%B7"><span class="nav-number">19.2.</span> <span class="nav-text">2. 理解数据标号</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Elite-X"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Elite-X</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/06/assemble/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Elite-X">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Elite-X">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="assembly language | Elite-X">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          assembly language
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-03-06 00:00:00" itemprop="dateCreated datePublished" datetime="2023-03-06T00:00:00-05:00">2023-03-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-03-08 02:17:44" itemprop="dateModified" datetime="2023-03-08T02:17:44-05:00">2023-03-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CSAPP/" itemprop="url" rel="index"><span itemprop="name">CSAPP</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p><meta name="referrer" content="no-referrer"><br><a name="MTE7s"></a></p>
<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>前前后后看完这本书，做完所有实验和检测点，用了接近一个月的时间，除了最后几天比较认真，其余时间是比较懒散的，这本书其实最多半个月就能解决掉。接下来会步入CSAPP第三章的学习，争取早日把有名的attack lab完成了</p>
<h2 id><a href="#" class="headerlink" title></a><span id="more"></span></h2><p><a name="PhqOH"></a></p>
<h1 id="实验1-查看CPU和内存，用机器指令和汇编指令编程"><a href="#实验1-查看CPU和内存，用机器指令和汇编指令编程" class="headerlink" title="实验1 查看CPU和内存，用机器指令和汇编指令编程"></a>实验1 查看CPU和内存，用机器指令和汇编指令编程</h1><p><a name="xymUo"></a></p>
<h2 id="debug环境搭建：参考此文"><a href="#debug环境搭建：参考此文" class="headerlink" title="debug环境搭建：参考此文"></a>debug环境搭建：<a target="_blank" rel="noopener" href="https://blog.csdn.net/YuzuruHanyu/article/details/80287419?spm=1001.2014.3001.5506">参考此文</a></h2><p><a name="UrdzB"></a></p>
<h2 id="assignment-1"><a href="#assignment-1" class="headerlink" title="assignment 1"></a>assignment 1</h2><ol>
<li>用A命令向内存中写入汇编指令，用U命令查看</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673249473372-3a80b2ab-d9e2-483c-ac41-140d30fdd765.png" alt="image.png"></p>
<ol>
<li>用R命令分别修改CS、IP寄存器，即CS:IP的指向，用T命令逐条执行</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673249669344-d36231e5-8310-46ba-a3c6-155e2601ff58.png" alt="image.png"><br><a name="rTW1r"></a></p>
<h2 id="assignment-2"><a href="#assignment-2" class="headerlink" title="assignment 2"></a>assignment 2</h2><ol>
<li>写入并查看指令</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673250172971-61fbb876-feda-4ca9-b81d-e558cc0e5a6a.png" alt="image.png"></p>
<ol>
<li>修改_CS:IP_指向</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673250237721-ec3e62f5-f6bc-4890-8f25-b62f6d89e60e.png" alt="image.png"></p>
<ol>
<li>执行指令，计算$2^8$，结果为 $AX = 0100H$</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673250558182-3582fd8d-9783-421c-9731-0d83ae5c81a8.png" alt="image.png"><br><a name="QAZ3Z"></a></p>
<h2 id="assignment-3"><a href="#assignment-3" class="headerlink" title="assignment 3"></a>assignment 3</h2><ol>
<li>用D命令查找，最终在$FFFF5H \to FFFFCH（FFFF:0005 \to FFFF:000C）$发现$dd/mm/yy$字样的生产日期</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673251622812-ca79ef23-5a2a-46b2-ba9f-326aa9d3bc54.png" alt="image.png"></p>
<ol>
<li>尝试用E命令修改，该操作失效，因为这是ROM</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673251941938-25cdf39e-5c26-49a3-81da-f108dff28da7.png" alt="image.png"><br><a name="CHS7t"></a></p>
<h2 id="assignment-4"><a href="#assignment-4" class="headerlink" title="assignment 4"></a>assignment 4</h2><p>1.$A0000H \to BFFFFH$对8086 PC机是显存地址，往这个范围内的内存写入数据，会改变显示器上的内容，我们可以看见屏幕上出现了笑脸、爱心和钻石<br><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673253290191-823908a7-61e0-4e4d-ac20-66184b8a4509.png" alt="image.png"></p>
<hr>
<p><a name="hcb7h"></a></p>
<h1 id="实验2-用机器指令和汇编指令编程"><a href="#实验2-用机器指令和汇编指令编程" class="headerlink" title="实验2 用机器指令和汇编指令编程"></a>实验2 用机器指令和汇编指令编程</h1><p><a name="vDc8z"></a></p>
<h2 id="assignment-1-1"><a href="#assignment-1-1" class="headerlink" title="assignment 1"></a>assignment 1</h2><ol>
<li>用A指令向内存中写入汇编指令，用U指令查看</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673596808599-b129a717-4d20-42a3-8823-64dc726440e3.png" alt="image.png"></p>
<ol>
<li>修改CS:IP使其指向代码段</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673596896692-f6335ebe-e9b7-44cf-9a38-d686dde7d140.png" alt="image.png"></p>
<ol>
<li>t命令逐步执行指令后查看AX、BX、SP寄存器内容</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673597028389-791ccf84-0268-4f23-976f-53e6ecd97b36.png" alt="image.png"><br><a name="NB9fg"></a></p>
<h2 id="assignment-2-1"><a href="#assignment-2-1" class="headerlink" title="assignment 2"></a>assignment 2</h2><p>在使用T命令进行单步追踪的时候，产生了中断，为了保护现场，CPU将PSW、CS和IP依此入栈，导致了内存相关位置内容的改变（保留疑问）</p>
<hr>
<p><a name="jpe3I"></a></p>
<h1 id="实验3-编程、编译、链接、跟踪"><a href="#实验3-编程、编译、链接、跟踪" class="headerlink" title="实验3 编程、编译、链接、跟踪"></a>实验3 编程、编译、链接、跟踪</h1><p><a name="QMUAH"></a></p>
<h2 id="assignment-1-2"><a href="#assignment-1-2" class="headerlink" title="assignment 1"></a>assignment 1</h2><ol>
<li>编译链接生成可执行文件</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673681789903-cb9f13be-b044-4c3f-be1d-8fa401195306.png" alt="image.png"><br><a name="bm7kI"></a></p>
<h2 id="assignment-2-2"><a href="#assignment-2-2" class="headerlink" title="assignment 2"></a>assignment 2</h2><ol>
<li>debug将程序载入内存，设置CS:IP：程序所在内存段的段地址为$DS=075C$，则PSP的地址为$075C:0$，程序的地址为$076C:0\;(075C+10:0)$,$CS:IP = 076C:0000$</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673682350829-98451696-0d75-4414-87c5-b527b5c96169.png" alt="image.png"></p>
<ol>
<li>跟踪程序执行过程</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673682565168-917f19d2-8e0c-44ab-84e5-453c301bcda0.png" alt="image.png"><br><a name="fqp3r"></a></p>
<h2 id="assignment-3-1"><a href="#assignment-3-1" class="headerlink" title="assignment 3"></a>assignment 3</h2><ol>
<li>查看PSP的内容</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673682886059-386e1af8-2b73-480f-92b1-d2ea01cce40a.png" alt="image.png"></p>
<hr>
<p><a name="eTiIA"></a></p>
<h1 id="实验4-bx-和loop的使用"><a href="#实验4-bx-和loop的使用" class="headerlink" title="实验4 [bx]和loop的使用"></a>实验4 [bx]和loop的使用</h1><p><a name="Ypsn2"></a></p>
<h2 id="assignment-1-3"><a href="#assignment-1-3" class="headerlink" title="assignment 1"></a>assignment 1</h2><ol>
<li><p>编写源程序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">assume cs:codesg</span><br><span class="line"></span><br><span class="line">codesg segment</span><br><span class="line"></span><br><span class="line">mov ax, 0020H</span><br><span class="line">mov ds, ax</span><br><span class="line">mov bx, 0</span><br><span class="line">mov dx, 0</span><br><span class="line">mov cx, 64</span><br><span class="line"></span><br><span class="line">s: </span><br><span class="line">mov [bx],dx</span><br><span class="line">inc bx</span><br><span class="line">inc dx</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">mov ax, 4c00h </span><br><span class="line">int 21h</span><br><span class="line"></span><br><span class="line">codesg ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>编译，链接生成可执行文件</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673769654198-dcf5a11b-b298-4d67-ac52-e6412baa7953.png" alt="image.png"></p>
<ol>
<li>查看载入内存的程序，可以看见标签s已被替换为地址$076C:000E$</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673770040980-f6175097-5e41-41f0-a0d4-ed6dcc9e2d26.png" alt="image.png"></p>
<ol>
<li>执行程序，验证结果，正确</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673770269260-0b535c86-7318-4bea-9b9b-151df8786503.png" alt="image.png"><br><a name="q95Oy"></a></p>
<h2 id="assignment-2-3"><a href="#assignment-2-3" class="headerlink" title="assignment 2"></a>assignment 2</h2><ol>
<li><p>编写源程序：将bx寄存器两用，即作偏移地址，又作操作数，可将程序缩短为9条指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">assume cs:codesg</span><br><span class="line"></span><br><span class="line">codesg segment</span><br><span class="line"></span><br><span class="line">mov ax, 0020H</span><br><span class="line">mov ds, ax</span><br><span class="line">mov bx, 0</span><br><span class="line">mov cx, 64</span><br><span class="line"></span><br><span class="line">s: </span><br><span class="line">mov [bx],bx</span><br><span class="line">inc bx</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">mov ax, 4c00h </span><br><span class="line">int 21h</span><br><span class="line"></span><br><span class="line">codesg ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>其它步骤与assigment 1一致，验证结果，正确</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673771416582-e853218d-46c6-4bf8-98d6-cacae4200dbb.png" alt="image.png"><br><a name="b3BKL"></a></p>
<h2 id="assignment-3-2"><a href="#assignment-3-2" class="headerlink" title="assignment 3"></a>assignment 3</h2><ol>
<li>复制的是什么：复制程序的第一条指令<code>mov ax,cs</code>到 <code>loop s</code> 指令至内存地址$0020:0000$处</li>
<li>如何知道程序的字节数：首先可以确定第一个空应该填入CS，这是程序的段地址，其次在<code>mov cx,_____</code> 上先随意填一个1，用debug跟踪程序，用U命令查看程序所占地址范围：$076C:0000 \to 076C:0015$，共$16H\,(23D)$个字节,因此第二个空应该填入$16H$</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673774640766-de55642e-4594-4add-9f75-ac17f9cf3628.png" alt="image.png"></p>
<hr>
<p><a name="l6DRo"></a></p>
<h1 id="实验5-编写、调试具有多个段的程序"><a href="#实验5-编写、调试具有多个段的程序" class="headerlink" title="实验5 编写、调试具有多个段的程序"></a>实验5 编写、调试具有多个段的程序</h1><p><a name="y07m5"></a></p>
<h2 id="assignment-1-4"><a href="#assignment-1-4" class="headerlink" title="assignment 1"></a>assignment 1</h2><ol>
<li>将程序载入内存后查看，可知data段段地址为$076C$, stack段段地址为$076D$，code段段地址为$076E$</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673877104816-d24fcee5-293b-4965-a116-55b74e84812c.png" alt="image.png"></p>
<ol>
<li>Q1：<code>G 001D</code>执行程序至程序返回前，用U命令查看data段内容: $0123H,0456H,0789H,0ABCH,0DEFH,0FEDH,0CBAH,0987H$，与初状态(源程序)一致，该程序按顺序做了入栈和出栈操作，因此数据不变</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673877337524-5a528fcf-a7ec-47a7-ba04-6014616d76ff.png" alt="image.png"></p>
<ol>
<li>Q2：R命令查看各个段寄存器的值  $\to \;CS:076E$、 $DS:076C$、$SS:076D$</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673877858110-72e7472f-1574-4c88-ae28-a064f40894e4.png" alt="image.png"></p>
<ol>
<li><p>Q3：data段和stack段分别占16个字节，因此设code段段地址为$X$，那么stack段段地址为$X-1H$，data段段地址为$X-2H$（做了assignment2后可以发现这里说法并不准确）<br><a name="qSFne"></a></p>
<h2 id="assignment-2-4"><a href="#assignment-2-4" class="headerlink" title="assignment 2"></a>assignment 2</h2></li>
<li><p>步骤与assigment1 完全一致</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673878358257-7f67627a-48a8-45cf-bc4a-1f51e9552faa.png" alt="image.png"></p>
<ol>
<li><p>得出结论：段无论大小，在源程序载入内存后，段所占内存大小一定为16的整数倍<br><a name="AiceH"></a></p>
<h2 id="assignment-3-3"><a href="#assignment-3-3" class="headerlink" title="assignment 3"></a>assignment 3</h2></li>
<li><p>步骤与assignment1完全一致</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673879121558-74eaedb2-acd9-4a9c-a318-e028bba49db2.png" alt="image.png"><br>2， 设code段段地址为$X$，那么data段段地址为$X+3H$，stack段段地址为$X+4H$<br><a name="NxsNH"></a></p>
<h2 id="assignment-4-1"><a href="#assignment-4-1" class="headerlink" title="assignment 4"></a>assignment 4</h2><p>如果去掉通知编译器程序的入口的<code>end start</code>语句，那么唯一可正确运行的是起始段为code段的程序3<br><a name="oVwXx"></a></p>
<h2 id="assignment-5"><a href="#assignment-5" class="headerlink" title="assignment 5"></a>assignment 5</h2><ol>
<li><p>编写源程序，注意在将段地址写入$DS$时，要借助一个寄存器充当介质，因为立即数无法直接写入$DS$</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">a segment </span><br><span class="line">db 1,2,3,4,5,6,7,8</span><br><span class="line">a ends</span><br><span class="line"></span><br><span class="line">b segment</span><br><span class="line">db 1,2,3,4,5,6,7,8</span><br><span class="line">b ends</span><br><span class="line"></span><br><span class="line">c segment </span><br><span class="line">db 0,0,0,0,0,0,0,0</span><br><span class="line">c ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov bx, 0</span><br><span class="line">mov cx, 8</span><br><span class="line">s:</span><br><span class="line">mov dx, a</span><br><span class="line">mov ds,dx</span><br><span class="line">mov ax, [bx]</span><br><span class="line">mov dx, b</span><br><span class="line">mov ds,dx</span><br><span class="line">add ax, [bx]</span><br><span class="line">mov dx, c</span><br><span class="line">mov ds,dx</span><br><span class="line">mov [bx], ax</span><br><span class="line">inc bx</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">mov ax,4c00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line"></span><br><span class="line">end start</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>用debug跟踪程序，可以看到a段段地址：$076C$、b段段地址：$076D$、c段段地址：$076E$</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673882442409-a3ef513e-eb43-4f18-abf5-ea6f262cc3f6.png" alt="image.png"></p>
<ol>
<li>执行程序，查看c段内容，正确</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673882790995-352f2b4b-203d-458a-b5a2-878acfd29335.png" alt="image.png"><br><a name="azFBM"></a></p>
<h2 id="assignment-6"><a href="#assignment-6" class="headerlink" title="assignment 6"></a>assignment 6</h2><ol>
<li><p>编写源程序，注意bx变化值应为2，因为push、pop操作是以字为单位的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">a segment</span><br><span class="line">dw 1,2,3,4,5,6,7,8,9,0ah,0bh,0ch,0dh,0eh,0fh,0ffh</span><br><span class="line">a ends</span><br><span class="line"></span><br><span class="line">b segment </span><br><span class="line">dw 0,0,0,0,0,0,0,0</span><br><span class="line">b ends</span><br><span class="line"></span><br><span class="line">code segment </span><br><span class="line">start:</span><br><span class="line">mov ax, a</span><br><span class="line">mov ds, ax</span><br><span class="line">mov ax, b </span><br><span class="line">mov ss, ax</span><br><span class="line">mov sp, 0010H</span><br><span class="line">mov bx, 0</span><br><span class="line">mov cx, 8</span><br><span class="line">s:</span><br><span class="line">push [bx]</span><br><span class="line">add bx, 2</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">mov ax, 4c00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line"></span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
</li>
<li><p>用debug跟踪程序，可以看到a段段地址： $076C$ 、 b段段地址：$076E$、code段段地址：$076F$</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673885232599-a5e6bf92-ae97-421b-ad5b-904f427aef76.png" alt="image.png"></p>
<ol>
<li>执行程序，查看b段内容，正确</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673885271367-eddf0cc8-98aa-4fe8-a38f-a014ed5f8179.png" alt="image.png"></p>
<hr>
<p><a name="O7BgM"></a></p>
<h1 id="实验6-实践课程中的程序"><a href="#实验6-实践课程中的程序" class="headerlink" title="实验6 实践课程中的程序"></a>实验6 实践课程中的程序</h1><p><a name="dyxQS"></a></p>
<h2 id="assignment-1-5"><a href="#assignment-1-5" class="headerlink" title="assignment 1"></a>assignment 1</h2><ol>
<li><p>这里只实践了问题7.8的解决方案（用栈作数据缓冲区），如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">assume cs:codesg, ds:datasg, ss:stacksg</span><br><span class="line"></span><br><span class="line">datasg segment </span><br><span class="line">db &#x27;ibm             &#x27;</span><br><span class="line">db &#x27;dec             &#x27;</span><br><span class="line">db &#x27;dos             &#x27;</span><br><span class="line">db &#x27;vax             &#x27;</span><br><span class="line">datasg ends</span><br><span class="line"></span><br><span class="line">stacksg segment</span><br><span class="line">dw 0,0,0,0,0,0,0,0</span><br><span class="line">stacksg ends</span><br><span class="line"></span><br><span class="line">codesg segment</span><br><span class="line">start:</span><br><span class="line">mov ax, stacksg</span><br><span class="line">mov ss, ax</span><br><span class="line">mov sp, 10H</span><br><span class="line">mov ax, datasg</span><br><span class="line">mov ds, ax</span><br><span class="line">mov bx, 0</span><br><span class="line">mov cx, 4</span><br><span class="line">s0:</span><br><span class="line">push cx</span><br><span class="line">mov si, 0</span><br><span class="line">mov cx, 3</span><br><span class="line">s:</span><br><span class="line">mov al, [bx+si]</span><br><span class="line">and al, 11011111B</span><br><span class="line">mov [bx+si], al</span><br><span class="line">inc si</span><br><span class="line">loop s </span><br><span class="line"></span><br><span class="line">pop cx</span><br><span class="line">add bx, 10H</span><br><span class="line">loop s0</span><br><span class="line"></span><br><span class="line">mov ax, 4c00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">codesg ends</span><br><span class="line"></span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
</li>
<li><p>跟踪程序，查看data段内容</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673954476992-988989f0-7ba5-4132-8b53-011e5cfe1ce7.png" alt="image.png"></p>
<ol>
<li>执行程序后，查看data段内容，正确</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673954644257-b63d5af0-f266-4057-b1e1-c513e09c9298.png" alt="image.png"><br><a name="pHbEJ"></a></p>
<h2 id="assignment-2-5"><a href="#assignment-2-5" class="headerlink" title="assignment 2"></a>assignment 2</h2><ol>
<li><p>编写源程序，双层循环中，进入第二层循环之后立马将cx压入栈中暂存，可避免双层循环在使用cx寄存器上的冲突</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">assume cs:codesg, ds:datasg, ss:stacksg</span><br><span class="line"></span><br><span class="line">stacksg segment</span><br><span class="line">dw 0,0,0,0,0,0,0,0</span><br><span class="line">stacksg ends</span><br><span class="line"></span><br><span class="line">datasg segment </span><br><span class="line">db &#x27;1. display      &#x27;</span><br><span class="line">db &#x27;2. brows        &#x27;</span><br><span class="line">db &#x27;3. replace      &#x27;</span><br><span class="line">db &#x27;4. modify       &#x27;</span><br><span class="line">datasg ends</span><br><span class="line"></span><br><span class="line">codesg segment</span><br><span class="line">start:</span><br><span class="line">mov ax, stacksg</span><br><span class="line">mov ss, ax</span><br><span class="line">mov sp, 10H </span><br><span class="line">mov ax, datasg</span><br><span class="line">mov ds, ax</span><br><span class="line">mov bx, 0</span><br><span class="line">mov cx, 4</span><br><span class="line">s0:</span><br><span class="line">push cx</span><br><span class="line">mov cx, 4</span><br><span class="line">mov si, 0</span><br><span class="line">s: </span><br><span class="line">mov al, [bx+3+si]</span><br><span class="line">and al, 11011111B</span><br><span class="line">mov [bx+3+si], al</span><br><span class="line">inc si</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">pop cx</span><br><span class="line">add bx, 10H</span><br><span class="line">loop s0</span><br><span class="line"></span><br><span class="line">mov ax, 4c00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">codesg ends</span><br><span class="line"></span><br><span class="line">end start</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>跟踪程序，查看data段内容</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673955793129-198d15a6-56f1-4375-a4c1-fa6d84e6aa7c.png" alt="image.png"></p>
<ol>
<li>执行程序，查看data段内容，正确</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1673955864652-707fd6d7-d65d-4be6-b3f9-bbcbbc27484b.png" alt="image.png"></p>
<hr>
<p><a name="MJU1z"></a></p>
<h1 id="实验7-寻址方式在结构化数据访问中的应用"><a href="#实验7-寻址方式在结构化数据访问中的应用" class="headerlink" title="实验7 寻址方式在结构化数据访问中的应用"></a>实验7 寻址方式在结构化数据访问中的应用</h1><ol>
<li><p>编写源程序，用<code>word ptr / byte ptr</code>指定内存单元大小主要应用在<code>div</code>指令或用于向内存写入立即数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">assume cs:codesg</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">dw 0,0,0,0,0,0,0,0</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">data segment</span><br><span class="line">db &#x27;1975&#x27;,&#x27;1976&#x27;, &#x27;1977&#x27;, &#x27;1978&#x27;, &#x27;1979&#x27;, &#x27;1980&#x27;, &#x27;1981&#x27;, &#x27;1982&#x27;,&#x27;1983&#x27;</span><br><span class="line">db &#x27;1984&#x27;, &#x27;1985&#x27;, &#x27;1986&#x27;, &#x27;1987&#x27;, &#x27;1988&#x27;, &#x27;1989&#x27;, &#x27;1990&#x27;, &#x27;1991&#x27;, &#x27;1992&#x27;</span><br><span class="line">db &#x27;1993&#x27;, &#x27;1994&#x27;, &#x27;1995&#x27;</span><br><span class="line"></span><br><span class="line">dd 16,22,382,1356,2390, 8000, 16000,24486,50065, 97479,140417,197514</span><br><span class="line">dd 345980,590827,803530,1183000,1843000,2759000, 3753000, 4649000,5937000</span><br><span class="line"></span><br><span class="line">dw 3,7,9,13,28,38,130,220,476,778,1001,1442,2258,2793, 4037,5635, 8226</span><br><span class="line">dw 11542,14430,15257,17800</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">table segment</span><br><span class="line">db 21 dup (&#x27;year summ ne ?? &#x27;)</span><br><span class="line">table ends</span><br><span class="line"></span><br><span class="line">codesg segment</span><br><span class="line">start:</span><br><span class="line">mov ax, stack ;0776C</span><br><span class="line">mov ss, ax</span><br><span class="line">mov sp, 10H</span><br><span class="line">mov ax, data ; 076D</span><br><span class="line">mov es, ax</span><br><span class="line">mov ax, table ; 077b</span><br><span class="line">mov ds, ax</span><br><span class="line">mov bx,0</span><br><span class="line">mov si,0</span><br><span class="line">mov cx,21</span><br><span class="line"></span><br><span class="line">year:</span><br><span class="line">push cx</span><br><span class="line">mov cx, 4</span><br><span class="line">mov di, 0</span><br><span class="line">char:</span><br><span class="line">mov al, es:[si]</span><br><span class="line">mov [bx+di], al</span><br><span class="line">inc di</span><br><span class="line">inc si</span><br><span class="line">loop char</span><br><span class="line">pop cx</span><br><span class="line">add bx, 10H</span><br><span class="line">loop year</span><br><span class="line"></span><br><span class="line">mov cx, 21</span><br><span class="line">mov bx, 0</span><br><span class="line">income:</span><br><span class="line">push cx</span><br><span class="line">mov cx, 2</span><br><span class="line">mov di, 0</span><br><span class="line">dwInt:</span><br><span class="line">mov ax, es:[si]</span><br><span class="line">mov [bx].5[di], ax</span><br><span class="line">add si, 2</span><br><span class="line">add di, 2</span><br><span class="line">loop dwInt</span><br><span class="line">pop cx</span><br><span class="line">add bx, 10H</span><br><span class="line">loop income</span><br><span class="line"></span><br><span class="line">mov cx, 21</span><br><span class="line">mov bx, 0</span><br><span class="line">staff:</span><br><span class="line">mov ax, es:[si]</span><br><span class="line">mov [10+bx], ax</span><br><span class="line">add si, 2;</span><br><span class="line">add bx, 10H</span><br><span class="line">loop staff</span><br><span class="line"></span><br><span class="line">mov cx, 21</span><br><span class="line">mov bx, 0</span><br><span class="line">average:</span><br><span class="line">mov dx, [bx+7]</span><br><span class="line">mov ax, [bx+5]</span><br><span class="line">div word ptr [bx+0AH]</span><br><span class="line">mov [bx+0Dh], ax</span><br><span class="line">add bx, 10H</span><br><span class="line">loop average</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line">codesg ends</span><br><span class="line">end start </span><br></pre></td></tr></table></figure>
</li>
<li><p>查看原始table段的内容</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1674054412418-905eb553-63b9-4352-8fd3-87d9c57ec955.png" alt="image.png"></p>
<ol>
<li>执行程序后，查看table段的内容，正确</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1674054465034-493bafb1-d935-4da9-b3d0-07b0bdd54911.png" alt="image.png"><br><a name="wI3bu"></a></p>
<h1 id="实验8-分析一个奇怪的程序"><a href="#实验8-分析一个奇怪的程序" class="headerlink" title="实验8 分析一个奇怪的程序"></a>实验8 分析一个奇怪的程序</h1><ol>
<li>程序从$start$入口处开始执行，一个<code>nop</code>指令占一个字节并表示No operation，此处用了两个<code>nop</code>指令的目的是在$s$处预留两个字节的空间，程序执行<code>mov cs:[di], ax</code>之后$s$处的两个字节被试图写入<code>jmp short s1</code>，接着程序向下执行<code>jmp short s</code>使得程序跳转回$s$处开始执行。</li>
<li><code>jmp short s1</code>到底做了什么：修改IP使其前进十个字节。因为该指令本身的作用是使IP从$s2$跳转到$s1$，即从$s2$处的jmp指令的下一指令<code>nop</code>$(076C:0022)$跳转到$s1$处的<code>mov ax, 0</code>$(076C:0018)$，因为<code>jmp short 标号</code>是依据位移进行转移的指令，而此处位移大小为$0022H-0018H =-10D(F6H)$，所以$s$处的<code>jmp short s</code>指令的机器码为<code>EBF6</code>（刚好占两个字节，因此可以被正确写入$s$处）</li>
<li>执行$s$处的跳转指令，使得$IP = IP+(-10)$,即向前移动十位，用debug跟踪程序，可以看到向前第十个指令为<code>mov ax, 4c00H</code>$(000AH-0010H=0000H)$，程序从此处开始向下执行，最终可以正确退出</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1674306714709-54439679-a96b-496d-97b1-de0f2c3abf77.png" alt="image.png"><br><a name="lZyJr"></a></p>
<h1 id="实验9-根据材料编程"><a href="#实验9-根据材料编程" class="headerlink" title="实验9 根据材料编程"></a>实验9 根据材料编程</h1><ol>
<li><p>编写源程序：最开始我试图用<code>mov address，data</code>的形式直接向显存中写入数据，并且比较蠢的一个字符一个字符的输入，但这种形式的mov指令对显存区域似乎并不奏效，实操之后发现显存内容未被修改为给定值，并且其内容还在动态的变化(?)。之后利用栈存储数据<code>welcome to masm!</code>，利用寄存器$ax$作介质，用mov指令实现内存之间的内容交换，避免了重复手动输入数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">assume cs:codesg</span><br><span class="line"></span><br><span class="line">data segment</span><br><span class="line">db &#x27;welcome to masm!&#x27;</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">codesg segment</span><br><span class="line">start: </span><br><span class="line">mov ax, data</span><br><span class="line">mov ds, ax</span><br><span class="line">mov ax, 0B800H</span><br><span class="line">mov es, ax</span><br><span class="line"></span><br><span class="line">mov bx, 0</span><br><span class="line">mov si, 1824</span><br><span class="line">mov cx, 10H</span><br><span class="line">s0:</span><br><span class="line">mov ah, 82H</span><br><span class="line">mov al, [bx]</span><br><span class="line">mov es:[si], ax</span><br><span class="line">inc bx</span><br><span class="line">add si, 2</span><br><span class="line">loop s0</span><br><span class="line"></span><br><span class="line">mov bx, 0 </span><br><span class="line">mov si, 1984</span><br><span class="line">mov cx, 10H</span><br><span class="line">s1:</span><br><span class="line">mov ah, 0A4H</span><br><span class="line">mov al, [bx]</span><br><span class="line">mov es:[si], ax</span><br><span class="line">inc bx</span><br><span class="line">add si, 2</span><br><span class="line">loop s1</span><br><span class="line"></span><br><span class="line">mov bx, 0 </span><br><span class="line">mov si, 2144</span><br><span class="line">mov cx, 10H</span><br><span class="line">s2:</span><br><span class="line">mov ah, 11110001B</span><br><span class="line">mov al, [bx]</span><br><span class="line">mov es:[si], ax</span><br><span class="line">inc bx</span><br><span class="line">add si, 2</span><br><span class="line">loop s2</span><br><span class="line"></span><br><span class="line">mov ax, 4c00H</span><br><span class="line">int 21H</span><br><span class="line">codesg ends</span><br><span class="line"></span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
</li>
<li><p>最终效果</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1674447541217-19494cef-6da4-4fd3-b28c-6ad18c755471.png" alt="image.png"></p>
<p><a name="zPzcC"></a></p>
<h1 id="实验10-编写子程序"><a href="#实验10-编写子程序" class="headerlink" title="实验10 编写子程序"></a>实验10 编写子程序</h1><p><a name="Z9mXL"></a></p>
<h2 id="assignment-1-6"><a href="#assignment-1-6" class="headerlink" title="assignment 1"></a>assignment 1</h2><ol>
<li><p>编写源程序，在子程序的开始将所有子程序将用的寄存器保存在栈中（不论子程序是否修改寄存器或返回后主程序是否使用寄存器，都应当这样做），以便从子程序返回前再恢复（<strong>注意入栈顺序与出栈顺序相反</strong>）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">data segment</span><br><span class="line">db &quot;welcome to masm!&quot;, 0</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">dw 16 dup (0)</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov dh, 8</span><br><span class="line">mov dl, 3</span><br><span class="line">mov cl, 2</span><br><span class="line">mov ax, data</span><br><span class="line">mov ds, ax</span><br><span class="line">mov ax, stack</span><br><span class="line">mov sp, 20H</span><br><span class="line">mov si, 0</span><br><span class="line">call show_str</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">show_str:</span><br><span class="line">push ax ; 保存子程序中所有将用到的寄存器的初始值，以便在返回前恢复</span><br><span class="line">push bx</span><br><span class="line">push cx</span><br><span class="line">push dx</span><br><span class="line">push es</span><br><span class="line">push si</span><br><span class="line"></span><br><span class="line">mov ax, 0B800H; 80×25彩色模式显示缓冲区</span><br><span class="line">mov es, ax</span><br><span class="line"></span><br><span class="line">mov al, 160 ; 设置指定打印位置</span><br><span class="line">inc dh ; 行数从0开始</span><br><span class="line">mul dh ; 8位乘法，结果存储在ax中</span><br><span class="line">mov bx, ax</span><br><span class="line">mov al, 2</span><br><span class="line">mul dl</span><br><span class="line">add bx, ax</span><br><span class="line">mov ah, cl</span><br><span class="line"></span><br><span class="line">print:</span><br><span class="line">mov cl, [si] ; 设置cx</span><br><span class="line">mov ch, 0</span><br><span class="line">jcxz ok ;判断字符串是否结束</span><br><span class="line"></span><br><span class="line">mov al, cl ; 设置字符属性和值</span><br><span class="line">mov es:[bx],ax</span><br><span class="line">inc si</span><br><span class="line">add bx, 2</span><br><span class="line">jmp print</span><br><span class="line"></span><br><span class="line">ok:</span><br><span class="line">pop si</span><br><span class="line">pop es</span><br><span class="line">pop dx</span><br><span class="line">pop cx</span><br><span class="line">pop bx</span><br><span class="line">pop ax</span><br><span class="line">ret </span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行结果</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1674959885930-a6c4181a-e6a1-44cb-9ec8-cc5013b1314e.png" alt="image.png"><br><a name="gCr3l"></a></p>
<h2 id="assignment-2-6"><a href="#assignment-2-6" class="headerlink" title="assignment 2"></a>assignment 2</h2><ol>
<li><p>编写源程序，利用除法溢出公式 </p>
<pre><code>            $X/n = int(H/2)*65536 +[rem(H/n)*65536+L]/n$&lt;br /&gt;该公式的基本思想是将可能发生除法溢出的32位除法$X/n$，分解为两个十六位(实际运算时是32位，被除数高16位置0)的除法&lt;br /&gt;$(H/n)*65536 + (L/n)$&lt;br /&gt;**商（32位）：**&lt;br /&gt;高十六位为$int(H/2)*65536$,低十六为$int([rem(H/n)*65536+L]/n)$&lt;br /&gt;**余数（16位）：**&lt;br /&gt;$rem([rem(H/n)*65536+L]/n)$&lt;br /&gt;（注：对这个公式的理解有限）
</code></pre><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">dw 16 dup (0)</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, stack</span><br><span class="line">mov ss, ax</span><br><span class="line">mov sp, 20H</span><br><span class="line">mov ax, 4240H</span><br><span class="line">mov dx, 000FH</span><br><span class="line">mov cx, 0AH</span><br><span class="line">call divdw</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">divdw:</span><br><span class="line">push bx</span><br><span class="line"></span><br><span class="line">mov bx, ax ; 暂存L</span><br><span class="line">mov ax, dx ; H/N</span><br><span class="line">mov dx, 0</span><br><span class="line">div cx ; int(H/N)在ax中，rem(H/N)在dx中</span><br><span class="line"></span><br><span class="line">push ax ; 暂存int(H/N)，除数</span><br><span class="line"></span><br><span class="line">mov ax, bx; dx and ax constitute rem(H/N)*65535+L</span><br><span class="line">div cx ; ax store the result</span><br><span class="line">mov cx, dx</span><br><span class="line"></span><br><span class="line">pop dx ; int(H/N)</span><br><span class="line"></span><br><span class="line">pop bx</span><br><span class="line">ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行结果正确</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675050216892-a6c856a5-19e3-42a9-9dae-62052e8d077c.png" alt="image.png"><br><a name="wHNVn"></a></p>
<h2 id="assignment-3-4"><a href="#assignment-3-4" class="headerlink" title="assignment 3"></a>assignment 3</h2><ol>
<li><p>编写源程序：由于是从数字尾部开始构造字符串，所以用栈来暂存数据再合适不过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">data segment</span><br><span class="line">db 10 dup(0)</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">dw 16 dup(0)</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, 12666</span><br><span class="line">mov bx, data</span><br><span class="line">mov ds, bx</span><br><span class="line">mov si, 0</span><br><span class="line">mov bx, stack</span><br><span class="line">mov ss, bx</span><br><span class="line">mov sp, 20H</span><br><span class="line">call dtoc</span><br><span class="line"></span><br><span class="line">mov dh, 8</span><br><span class="line">mov dl, 3</span><br><span class="line">mov cl, 2</span><br><span class="line">call show_str</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">dtoc:</span><br><span class="line">push ax</span><br><span class="line">push bx</span><br><span class="line">push cx</span><br><span class="line">push dx</span><br><span class="line">push si</span><br><span class="line">push di</span><br><span class="line"></span><br><span class="line">mov dx, 0 ; 被除数高16位 置0</span><br><span class="line">mov bx, 10</span><br><span class="line">mov di, 0 ; 字符计数</span><br><span class="line"></span><br><span class="line">divide:</span><br><span class="line">mov cx, ax </span><br><span class="line">jcxz over</span><br><span class="line">inc di</span><br><span class="line">div bx ; 32位除法，商在ax，余数在dx</span><br><span class="line">add dx, 30H</span><br><span class="line">push dx</span><br><span class="line">mov dx, 0</span><br><span class="line">jmp divide</span><br><span class="line"></span><br><span class="line">over:</span><br><span class="line">mov cx, di</span><br><span class="line">move: </span><br><span class="line">pop bx</span><br><span class="line">mov [si], bl</span><br><span class="line">inc si</span><br><span class="line">loop move</span><br><span class="line"></span><br><span class="line">pop di</span><br><span class="line">pop si</span><br><span class="line">pop dx</span><br><span class="line">pop cx</span><br><span class="line">pop bx</span><br><span class="line">pop ax</span><br><span class="line">ret</span><br><span class="line"></span><br><span class="line">show_str:</span><br><span class="line">push ax ; 保存子程序中所有将用到的寄存器的初始值，以便在返回前恢复</span><br><span class="line">push bx</span><br><span class="line">push cx</span><br><span class="line">push dx</span><br><span class="line">push es</span><br><span class="line">push si</span><br><span class="line"></span><br><span class="line">mov ax, 0B800H; 80×25彩色模式显示缓冲区</span><br><span class="line">mov es, ax</span><br><span class="line"></span><br><span class="line">mov al, 160 ; 设置指定打印位置</span><br><span class="line">inc dh ; 行数从0开始</span><br><span class="line">mul dh ; 8位乘法，结果存储在ax中</span><br><span class="line">mov bx, ax</span><br><span class="line">mov dh, 0</span><br><span class="line">mov al, 2</span><br><span class="line">mul dl</span><br><span class="line">add bx, ax</span><br><span class="line">mov ah, cl</span><br><span class="line"></span><br><span class="line">print:</span><br><span class="line">mov cl, [si] ; 设置cx</span><br><span class="line">mov ch, 0</span><br><span class="line">jcxz ok ;判断字符串是否结束</span><br><span class="line"></span><br><span class="line">mov al, cl ; 设置字符属性和值</span><br><span class="line">mov es:[bx],ax</span><br><span class="line">inc si</span><br><span class="line">add bx, 2</span><br><span class="line">jmp print</span><br><span class="line"></span><br><span class="line">ok:</span><br><span class="line">pop si</span><br><span class="line">pop es</span><br><span class="line">pop dx</span><br><span class="line">pop cx</span><br><span class="line">pop bx</span><br><span class="line">pop ax</span><br><span class="line">ret </span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行结果</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675070403817-35e5aa0f-3d0c-42ab-803a-9d7dbf5bcb8a.png" alt="image.png"><br><a name="ww3wC"></a></p>
<h1 id="实验11-编写子程序"><a href="#实验11-编写子程序" class="headerlink" title="实验11 编写子程序"></a>实验11 编写子程序</h1><ol>
<li><p>编写源程序：主要用到了<code>cmp</code>指令和条件转移指令组合形成的if逻辑</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">assume cs:codesg</span><br><span class="line">datasg segment</span><br><span class="line">db &quot;Beginner&#x27;s All-purpose Symbolic Instruction Code.&quot;,0</span><br><span class="line">datasg ends</span><br><span class="line"></span><br><span class="line">codesg segment</span><br><span class="line">begin:</span><br><span class="line">mov ax, datasg</span><br><span class="line">mov ds, ax</span><br><span class="line">mov si, 0</span><br><span class="line">call letterc</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">letterc:</span><br><span class="line">push ax</span><br><span class="line">push cx</span><br><span class="line"></span><br><span class="line">Capital:</span><br><span class="line">mov al, [si]</span><br><span class="line">mov cl, al</span><br><span class="line">mov ch, 0</span><br><span class="line">jcxz OK</span><br><span class="line">cmp al, 97</span><br><span class="line">jb NO</span><br><span class="line">cmp al, 122</span><br><span class="line">ja NO</span><br><span class="line">and al, 11011111B</span><br><span class="line">mov [si], al	</span><br><span class="line"></span><br><span class="line">NO:</span><br><span class="line">inc si</span><br><span class="line">jmp short Capital</span><br><span class="line"></span><br><span class="line">OK:</span><br><span class="line">pop cx</span><br><span class="line">pop ax</span><br><span class="line">ret</span><br><span class="line"></span><br><span class="line">codesg ends</span><br><span class="line">end begin</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行结果</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675142887049-1e6b7958-8779-4745-81f5-c6a536a232ca.png" alt="image.png"><br><a name="bk4z5"></a></p>
<h1 id="实验12-编写0号中断的处理程序"><a href="#实验12-编写0号中断的处理程序" class="headerlink" title="实验12 编写0号中断的处理程序"></a>实验12 编写0号中断的处理程序</h1><ol>
<li>编写源程序</li>
</ol>
<p>总体来说就3个任务：</p>
<ul>
<li>编写中断处理程序 </li>
<li>复制中断处理程序至内存空闲区域($0000:0200H\to0000:02FFH$)  </li>
<li>修改中断向量表（中断处理程序地址入口表）</li>
</ul>
<p>注意在用<code>jcxz</code>条件转移指令时，要<code>jmp short</code>回程序开头<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, cs</span><br><span class="line">mov ds, ax</span><br><span class="line">mov si, offset do0 ; 076C:0028</span><br><span class="line">mov ax, 0</span><br><span class="line">mov es, ax</span><br><span class="line">mov di, 0200H</span><br><span class="line"></span><br><span class="line">mov cx, offset do0end- offset do0; 0034H</span><br><span class="line">cld</span><br><span class="line">rep movsb ; 复制程序到0:200</span><br><span class="line"></span><br><span class="line">mov word ptr es:[0], 0200H</span><br><span class="line">mov word ptr es:[0+2], 0 ; 修改中断向量表</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">do0:</span><br><span class="line">jmp short do0start</span><br><span class="line">db &quot;divide error&quot;,0 </span><br><span class="line"></span><br><span class="line">do0start:</span><br><span class="line">mov ax, 0B800H</span><br><span class="line">mov es, ax</span><br><span class="line">mov di, 160*12+34*2</span><br><span class="line"></span><br><span class="line">mov ax, cs</span><br><span class="line">mov ds, ax</span><br><span class="line">mov si, 202H</span><br><span class="line"></span><br><span class="line">print:</span><br><span class="line">mov cL, [si]</span><br><span class="line">mov ch, 0</span><br><span class="line">jcxz ok</span><br><span class="line">mov ah, 04h ;red</span><br><span class="line">mov al, cl</span><br><span class="line">mov es:[di], ax</span><br><span class="line">inc si</span><br><span class="line">add di, 2 </span><br><span class="line">jmp short print</span><br><span class="line"></span><br><span class="line">ok:</span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">do0end: ;005C</span><br><span class="line">nop</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure></p>
<ol>
<li>运行结果(在debug中运行检测程序lab12T无法触发中断，直接执行却可以)</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675159533550-89caf027-f6da-4345-aa8c-e03159df600e.png" alt="image.png"><br><a name="YSdgF"></a></p>
<h1 id="实验13-编写、应用中断例程"><a href="#实验13-编写、应用中断例程" class="headerlink" title="实验13 编写、应用中断例程"></a>实验13 编写、应用中断例程</h1><p><a name="HHw6N"></a></p>
<h2 id="assignment-1-7"><a href="#assignment-1-7" class="headerlink" title="assignment 1"></a>assignment 1</h2><ol>
<li><p>编写源程序：与lab10-1的show_str基本一致，只需将<code>call-ret</code>更改为 <code>int 7cH - iret</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, cs</span><br><span class="line">mov ds, ax</span><br><span class="line">mov si, offset print</span><br><span class="line">mov ax, 0</span><br><span class="line">mov es, ax</span><br><span class="line">mov di, 0200H</span><br><span class="line"></span><br><span class="line">mov cx, offset printed - offset print</span><br><span class="line">cld</span><br><span class="line">rep  movsb</span><br><span class="line"></span><br><span class="line">mov word ptr es:[7cH*4], 0200H</span><br><span class="line">mov word ptr es:[7cH*4+2], 0 </span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">print:</span><br><span class="line">push bx</span><br><span class="line">push cx</span><br><span class="line">push es</span><br><span class="line">push si</span><br><span class="line">push ax</span><br><span class="line">push dx</span><br><span class="line"></span><br><span class="line">mov ax, 0B800H</span><br><span class="line">mov es, ax</span><br><span class="line"></span><br><span class="line">mov al, 160</span><br><span class="line">inc dh</span><br><span class="line">mul dh ; 160*(10+1) in ax</span><br><span class="line">mov bx, ax</span><br><span class="line">mov al, 2</span><br><span class="line">mul dl ; 10*2 in ax</span><br><span class="line">add bx, ax</span><br><span class="line">mov ah, cl</span><br><span class="line"></span><br><span class="line">stPrint:</span><br><span class="line">mov ch, 0</span><br><span class="line">mov cl, [si]</span><br><span class="line">jcxz ok</span><br><span class="line"></span><br><span class="line">mov al, cl</span><br><span class="line">mov es:[bx], ax</span><br><span class="line">add bx, 2</span><br><span class="line">inc si</span><br><span class="line">jmp short stPrint</span><br><span class="line"></span><br><span class="line">ok:</span><br><span class="line">pop dx</span><br><span class="line">pop ax</span><br><span class="line">pop si</span><br><span class="line">pop es</span><br><span class="line">pop cx</span><br><span class="line">pop bx</span><br><span class="line">iret</span><br><span class="line"></span><br><span class="line">printed:</span><br><span class="line">nop</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行结果</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675224733068-a783d5cd-5d35-46b5-8032-3c8938e8347a.png" alt="image.png"><br><a name="LKaNX"></a></p>
<h2 id="assignment-2-7"><a href="#assignment-2-7" class="headerlink" title="assignment 2"></a>assignment 2</h2><ol>
<li>编写源程序</li>
</ol>
<p>用中断例程实现loop指令，主要需要解决三个问题</p>
<ul>
<li>怎么取得标号$S$的段地址和偏移地址？</li>
</ul>
<p>有一对段地址$CS$和偏移地址$IP$在中断过程时被压入栈，标号的段地址就是该CS，标号           的偏移地址可由该IP加上转移地址(<code>offset s - offset se</code>)得到</p>
<ul>
<li>得到$S$的段地址和偏移地址后，如何设置$CS:IP$</li>
</ul>
<p>用<code>iret</code>指令：<code>pop IP , pop CS ,  popf</code><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, cs</span><br><span class="line">mov ds, ax</span><br><span class="line">mov si, offset lp</span><br><span class="line">mov ax, 0</span><br><span class="line">mov es, ax</span><br><span class="line">mov di, 0200H</span><br><span class="line"></span><br><span class="line">mov cx, offset lped - offset lp</span><br><span class="line">cld</span><br><span class="line">rep  movsb</span><br><span class="line"></span><br><span class="line">mov word ptr es:[7cH*4], 0200H</span><br><span class="line">mov word ptr es:[7cH*4+2], 0 </span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">lp:</span><br><span class="line">dec cx</span><br><span class="line">jcxz lpret</span><br><span class="line">push bp</span><br><span class="line">mov bp, sp</span><br><span class="line">add [bp+2], bx</span><br><span class="line">lpret:</span><br><span class="line">pop bp</span><br><span class="line">iret</span><br><span class="line"></span><br><span class="line">lped:</span><br><span class="line">nop</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure></p>
<ol>
<li>运行结果</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675237825483-f1ed3d6d-00cc-453b-91b3-757823355468.png" alt="image.png"><br><a name="TCCAl"></a></p>
<h2 id="assignment-3-5"><a href="#assignment-3-5" class="headerlink" title="assignment 3"></a>assignment 3</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">s1: db &#x27;Good,better,best,&#x27;,&#x27;$&#x27;</span><br><span class="line">s2: db &#x27;Never let it rest,&#x27;,&#x27;$&#x27; </span><br><span class="line">s3: db &#x27;Till good is better,&#x27;,&#x27;$&#x27;</span><br><span class="line">s4: db &#x27;And better,best.&#x27;, &#x27;$&#x27;</span><br><span class="line">s: dw offset s1, offset s2, offset s3, offset s4 </span><br><span class="line">row: db 2,4,6,8</span><br><span class="line"></span><br><span class="line">start:</span><br><span class="line">mov ax, cs </span><br><span class="line">mov ds, ax</span><br><span class="line">mov bx, offset s</span><br><span class="line">mov si, offset row</span><br><span class="line">mov cx, 4</span><br><span class="line">ok:</span><br><span class="line">mov bh, 0 </span><br><span class="line">mov dh, [si]</span><br><span class="line">mov dl, 0</span><br><span class="line">mov ah, 2 ; BIOS中断例程--设置光标</span><br><span class="line">int 10h </span><br><span class="line"></span><br><span class="line">mov dx, [bx]                                           </span><br><span class="line">mov ah, 9 ; DOS中断例程--打印字符串</span><br><span class="line">int 21h</span><br><span class="line">inc si</span><br><span class="line">add bx, 2</span><br><span class="line">loop ok</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H; DOS中断例程--程序返回，返回值在al</span><br><span class="line">int 21H</span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
<p><a name="zGspx"></a></p>
<h1 id="实验14-访问-CMOS-RAM"><a href="#实验14-访问-CMOS-RAM" class="headerlink" title="实验14 访问 CMOS RAM"></a>实验14 访问 CMOS RAM</h1><ol>
<li><p>编写源程序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">dw 16 dup (0)</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, stack</span><br><span class="line">mov ss, ax</span><br><span class="line">mov sp, 20H</span><br><span class="line">mov ax, 0B800H</span><br><span class="line">mov ds, ax</span><br><span class="line"></span><br><span class="line">mov al, 9</span><br><span class="line">mov bx, 160*12+36*2</span><br><span class="line">call GetAscill</span><br><span class="line">mov byte ptr [bx+4], &#x27;/&#x27;</span><br><span class="line"></span><br><span class="line">mov al, 8</span><br><span class="line">add bx, 6</span><br><span class="line">call GetAscill</span><br><span class="line">mov byte ptr [bx+4], &#x27;/&#x27;</span><br><span class="line"></span><br><span class="line">mov al, 7</span><br><span class="line">add bx, 6</span><br><span class="line">call GetAscill</span><br><span class="line">mov byte ptr [bx+4], &#x27; &#x27;</span><br><span class="line"></span><br><span class="line">mov al, 4</span><br><span class="line">add bx, 6</span><br><span class="line">call GetAscill</span><br><span class="line">mov byte ptr [bx+4], &#x27;:&#x27;</span><br><span class="line"></span><br><span class="line">mov al, 2</span><br><span class="line">add bx, 6</span><br><span class="line">call GetAscill</span><br><span class="line">mov byte ptr [bx+4], &#x27;:&#x27;</span><br><span class="line"></span><br><span class="line">mov al, 0</span><br><span class="line">add bx, 6</span><br><span class="line">call GetAscill</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">GetAscill:</span><br><span class="line">push ax</span><br><span class="line">push bx</span><br><span class="line">push cx</span><br><span class="line">push dx</span><br><span class="line"></span><br><span class="line">out 70H, al</span><br><span class="line">in al, 71H</span><br><span class="line"></span><br><span class="line">mov ah, al</span><br><span class="line">mov cl, 4</span><br><span class="line">shr ah, cl</span><br><span class="line">and al, 00001111B</span><br><span class="line"></span><br><span class="line">add ah, 30H</span><br><span class="line">add al, 30H</span><br><span class="line"></span><br><span class="line">mov dx, 0B800H</span><br><span class="line">mov es, dx</span><br><span class="line">mov es:[bx], ah </span><br><span class="line">mov byte ptr es:[bx+1], 02H ; green</span><br><span class="line">mov es:[bx+2], al</span><br><span class="line">mov byte ptr es:[bx+3], 02H</span><br><span class="line"></span><br><span class="line">pop dx</span><br><span class="line">pop cx</span><br><span class="line">pop bx</span><br><span class="line">pop ax</span><br><span class="line">ret</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行结果</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675253920788-8fc4fee5-abeb-4e49-93bf-97e3873b6599.png" alt="image.png"><br><a name="yTwL0"></a></p>
<h1 id="实验15-安装新的int-9-中断例程"><a href="#实验15-安装新的int-9-中断例程" class="headerlink" title="实验15 安装新的int 9 中断例程"></a>实验15 安装新的int 9 中断例程</h1><p><a name="TIrMX"></a></p>
<h2 id="前置练习1"><a href="#前置练习1" class="headerlink" title="前置练习1"></a>前置练习1</h2><p>在屏幕中间依次显示$a\to z$,按Esc键后改变与颜色</p>
<ol>
<li><p>编写源程序：由于重新编写的int 9 例程与用于显示的程序在同时运行，所以不需要有安装程序。在编写int 9中断例程时，错把<code>call dword ptr ds:[0]</code>写成了<code>call word ptr ds:[0]</code>，导致整个系统没有正确的int 9中断例程，因此出现了错误。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">db 64 dup(0)</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">data segment</span><br><span class="line">dw 0,0</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, stack</span><br><span class="line">mov ss, ax</span><br><span class="line">mov sp, 40H</span><br><span class="line">mov ax, data</span><br><span class="line">mov ds, ax</span><br><span class="line"></span><br><span class="line">mov ax, 0</span><br><span class="line">mov es, ax</span><br><span class="line"></span><br><span class="line">push es:[9*4]</span><br><span class="line">pop ds:[0]</span><br><span class="line">push es:[9*4+2]</span><br><span class="line">pop ds:[2] ; 保存原int 9中断例程的入口地址</span><br><span class="line"></span><br><span class="line">cli</span><br><span class="line">mov word ptr es:[9*4], offset int9</span><br><span class="line">mov es:[9*4+2], cs;设置新的入口地址</span><br><span class="line">sti</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mov ax, 0B800H</span><br><span class="line">mov es,ax</span><br><span class="line">mov dh, &#x27;a&#x27;</span><br><span class="line">s:</span><br><span class="line">mov es:[160*12+40*2], dh</span><br><span class="line">call delay</span><br><span class="line">inc dh</span><br><span class="line">cmp dh, &#x27;z&#x27;</span><br><span class="line">jna s ; 依次打印a~z</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mov ax, 0 </span><br><span class="line">mov es, ax</span><br><span class="line"></span><br><span class="line">cli</span><br><span class="line">push ds:[0]</span><br><span class="line">pop es:[9*4]</span><br><span class="line">push ds:[2]</span><br><span class="line">pop es:[9*4+2] ;恢复原int 9中断例程的入口地址</span><br><span class="line">sti</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mov ax, 4C00h</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">delay:</span><br><span class="line">push ax</span><br><span class="line">push dx</span><br><span class="line">mov ax, 0</span><br><span class="line">mov dx, 10H</span><br><span class="line">se:</span><br><span class="line">sub ax, 1 ; 不能用dec</span><br><span class="line">sbb dx, 0</span><br><span class="line">cmp ax, 0</span><br><span class="line">jne se</span><br><span class="line">cmp dx, 0</span><br><span class="line">jne se</span><br><span class="line"></span><br><span class="line">pop dx</span><br><span class="line">pop ax</span><br><span class="line">ret ; 延时</span><br><span class="line"></span><br><span class="line">int9:</span><br><span class="line">push ax</span><br><span class="line">push es</span><br><span class="line">in al, 60H</span><br><span class="line"></span><br><span class="line">pushf</span><br><span class="line">call dword ptr ds:[0]</span><br><span class="line"></span><br><span class="line">cmp al, 01H</span><br><span class="line">jne int9ret</span><br><span class="line">mov ax, 0B800H</span><br><span class="line">mov es, ax</span><br><span class="line">inc byte ptr es:[160*12+40*2+1] ; 修改字符属性</span><br><span class="line"></span><br><span class="line">int9ret:</span><br><span class="line">pop es</span><br><span class="line">pop ax</span><br><span class="line">iret</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>运行结果</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675319548168-77f7b5a6-54bb-4526-b234-adb0e561004e.png" alt="image.png"><br><a name="vlBjq"></a></p>
<h2 id="前置练习2"><a href="#前置练习2" class="headerlink" title="前置练习2"></a>前置练习2</h2><p>在DOS下，按F1键后改变当前屏幕的显示颜色，其他的键照常处理</p>
<ol>
<li><p>编写源程序：原int 9的中断例程入口地址不能放在安装程序中，否则在进入新int 9中断例程后将丢失原int 9中断例程入口地址，导致无法调用原int 9中断例程。将原int 9中断例程入口地址放在$0:0200 \to 0:0203$,可在新int 9中断例程中通过<code>cs:[200H]</code>访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code, ss:stack</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">db 32 dup(0)</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, stack</span><br><span class="line">mov ss, ax</span><br><span class="line">mov sp, 20H</span><br><span class="line"></span><br><span class="line">mov ax, 0</span><br><span class="line">mov es, ax</span><br><span class="line">mov di, 0204H</span><br><span class="line">mov ax, cs</span><br><span class="line">mov ds, ax</span><br><span class="line">mov si, offset int9</span><br><span class="line"></span><br><span class="line">mov cx, offset int9ed - offset int9</span><br><span class="line">cld</span><br><span class="line">rep movsb; 安装</span><br><span class="line"></span><br><span class="line">push es:[9*4]</span><br><span class="line">pop es:[200H]</span><br><span class="line">push es:[9*4+2]</span><br><span class="line">pop es:[202H] ; 保存原int 9入口地址</span><br><span class="line"></span><br><span class="line">cli</span><br><span class="line">mov word ptr es:[9*4], 204H</span><br><span class="line">mov word ptr es:[9*4+2], 0 ; 修改中断向量表</span><br><span class="line">sti</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">int9:</span><br><span class="line">push ax</span><br><span class="line">push cx</span><br><span class="line">push es</span><br><span class="line">push di</span><br><span class="line"></span><br><span class="line">in al, 60H</span><br><span class="line"></span><br><span class="line">pushf</span><br><span class="line">call dword ptr cs:[200H] ; 调用原int 9</span><br><span class="line"></span><br><span class="line">cmp al, 3BH</span><br><span class="line">jne int9ret</span><br><span class="line"></span><br><span class="line">mov ax, 0B800H</span><br><span class="line">mov es, ax</span><br><span class="line">mov di, 1</span><br><span class="line">mov cx, 2000</span><br><span class="line">s:</span><br><span class="line">inc byte ptr es:[di]</span><br><span class="line">add di, 2</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">int9ret:</span><br><span class="line">pop di</span><br><span class="line">pop es</span><br><span class="line">pop cx</span><br><span class="line">pop ax</span><br><span class="line">iret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int9ed:</span><br><span class="line">nop</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行结果</p>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675322759364-2785ad21-17c7-4499-b1a3-fe6726975b02.png" alt="image.png"><br><a name="XyIu0"></a></p>
<h2 id="assignment-1-8"><a href="#assignment-1-8" class="headerlink" title="assignment 1"></a>assignment 1</h2><ol>
<li>编写源程序</li>
</ol>
<p>与前两个练习相差不大，判断字符条件不同而已：判断是否是字符A的断码<code>cmp aL, 1EH+80H</code><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code, ss:stack</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">db 32 dup(0)</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, stack</span><br><span class="line">mov ss, ax</span><br><span class="line">mov sp, 20H</span><br><span class="line"></span><br><span class="line">mov ax, 0</span><br><span class="line">mov es, ax</span><br><span class="line">mov di, 0204H</span><br><span class="line">mov ax, cs</span><br><span class="line">mov ds, ax</span><br><span class="line">mov si, offset int9</span><br><span class="line"></span><br><span class="line">mov cx, offset int9ed - offset int9</span><br><span class="line">cld</span><br><span class="line">rep movsb; 安装</span><br><span class="line"></span><br><span class="line">push es:[9*4]</span><br><span class="line">pop es:[200H]</span><br><span class="line">push es:[9*4+2]</span><br><span class="line">pop es:[202H] ; 保存原int 9入口地址</span><br><span class="line"></span><br><span class="line">cli</span><br><span class="line">mov word ptr es:[9*4], 204H</span><br><span class="line">mov word ptr es:[9*4+2], 0 ; 修改中断向量表</span><br><span class="line">sti</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">int9:</span><br><span class="line">push ax</span><br><span class="line">push cx</span><br><span class="line">push es</span><br><span class="line">push di</span><br><span class="line"></span><br><span class="line">in aL,60h</span><br><span class="line"></span><br><span class="line">pushf</span><br><span class="line">call dword ptr cs:[200H]</span><br><span class="line"></span><br><span class="line">cmp aL, 1EH+80H</span><br><span class="line">jne int9ret</span><br><span class="line"></span><br><span class="line">mov cx, 2000</span><br><span class="line">mov ax, 0B800H</span><br><span class="line">mov es, ax</span><br><span class="line">mov di, 0</span><br><span class="line">s:</span><br><span class="line">mov byte ptr es:[di], &#x27;A&#x27;</span><br><span class="line">mov byte ptr es:[di+1], 02H</span><br><span class="line">add di, 2</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">int9ret:</span><br><span class="line">pop di</span><br><span class="line">pop es</span><br><span class="line">pop cx</span><br><span class="line">pop ax</span><br><span class="line">iret</span><br><span class="line"></span><br><span class="line">int9ed:</span><br><span class="line">nop</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<ol>
<li>运行结果</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675329053483-60588212-d9b5-4cef-acf7-06c70f65db5f.png" alt="image.png"><br><a name="YodIM"></a></p>
<h1 id="实验16-编写包含多个功能子程序的中断例程"><a href="#实验16-编写包含多个功能子程序的中断例程" class="headerlink" title="实验16 编写包含多个功能子程序的中断例程"></a>实验16 编写包含多个功能子程序的中断例程</h1><ol>
<li>编写源程序</li>
</ol>
<p>注意中断例程安装后，直接定址表table的偏移地址发生了变化，没有了前面安装程序带来的一截偏移，同时偏移地址增加200H<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, cs</span><br><span class="line">mov ds, ax</span><br><span class="line">mov si, offset int7ch</span><br><span class="line">mov ax, 0</span><br><span class="line">mov es, ax</span><br><span class="line">mov di, 0200H</span><br><span class="line"></span><br><span class="line">mov cx, offset int7ched - offset int7ch</span><br><span class="line">cld</span><br><span class="line">rep  movsb</span><br><span class="line"></span><br><span class="line">mov word ptr es:[7cH*4], 0200H</span><br><span class="line">mov word ptr es:[7cH*4+2], 0 </span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">int7ch:</span><br><span class="line">jmp short int7chStart</span><br><span class="line">table dw offset Sub1-offset int7ch+200H, offset Sub2-offset int7ch+200H, offset Sub3-offset int7ch+200H, offset Sub4-offset int7ch+200H</span><br><span class="line"></span><br><span class="line">int7chStart:</span><br><span class="line">push ax</span><br><span class="line">push bx</span><br><span class="line">cmp ah, 3</span><br><span class="line">ja int7chRet</span><br><span class="line">mov bl, ah</span><br><span class="line">mov bh, 0</span><br><span class="line">add bx, bx</span><br><span class="line">call word ptr cs:(table-int7ch+200H)[bx]</span><br><span class="line"></span><br><span class="line">int7chRet:</span><br><span class="line">pop bx</span><br><span class="line">pop ax</span><br><span class="line">iret</span><br><span class="line"></span><br><span class="line">Sub1:</span><br><span class="line">push ax</span><br><span class="line">push bx</span><br><span class="line">push cx</span><br><span class="line">push ds</span><br><span class="line">mov ax, 0B800H</span><br><span class="line">mov ds, ax</span><br><span class="line">mov cx, 2000</span><br><span class="line">mov bx, 0</span><br><span class="line">s1:</span><br><span class="line">mov byte ptr [bx], &#x27; &#x27;</span><br><span class="line">add bx, 2</span><br><span class="line">loop s1</span><br><span class="line">pop ds</span><br><span class="line">pop cx</span><br><span class="line">pop bx</span><br><span class="line">pop ax</span><br><span class="line">ret</span><br><span class="line"></span><br><span class="line">Sub2:</span><br><span class="line">push ax</span><br><span class="line">push bx</span><br><span class="line">push cx</span><br><span class="line">push ds</span><br><span class="line">mov bx, 0B800H</span><br><span class="line">mov ds, bx</span><br><span class="line">mov cx, 2000</span><br><span class="line">mov bx, 1</span><br><span class="line">s2:</span><br><span class="line">and byte ptr [bx], 11111000B ; 只设置最后3位</span><br><span class="line">or byte ptr [bx], al</span><br><span class="line">add bx, 2</span><br><span class="line">loop s2</span><br><span class="line">pop ds</span><br><span class="line">pop cx</span><br><span class="line">pop bx</span><br><span class="line">pop ax</span><br><span class="line">ret</span><br><span class="line"></span><br><span class="line">Sub3:</span><br><span class="line">push ax</span><br><span class="line">push bx</span><br><span class="line">push cx</span><br><span class="line">push ds</span><br><span class="line">mov bx, 0B800H</span><br><span class="line">mov ds, bx</span><br><span class="line">mov cl, 4</span><br><span class="line">shl al, cl</span><br><span class="line">mov cx, 2000</span><br><span class="line">mov bx, 1</span><br><span class="line">s3:</span><br><span class="line">and byte ptr [bx], 10001111B</span><br><span class="line">or [bx], al</span><br><span class="line">add bx, 2</span><br><span class="line">loop s3</span><br><span class="line">pop ds</span><br><span class="line">pop cx</span><br><span class="line">pop bx</span><br><span class="line">pop ax</span><br><span class="line">ret</span><br><span class="line"></span><br><span class="line">Sub4:</span><br><span class="line">push ax</span><br><span class="line">push bx</span><br><span class="line">push cx</span><br><span class="line">push ds</span><br><span class="line">push es</span><br><span class="line">push si</span><br><span class="line">push di</span><br><span class="line">mov bx, 08B00H</span><br><span class="line">mov es, bx</span><br><span class="line">mov ds, bx</span><br><span class="line">mov si, 160</span><br><span class="line">mov di, 0</span><br><span class="line">cld</span><br><span class="line">mov cx, 24</span><br><span class="line"></span><br><span class="line">s4:</span><br><span class="line">push cx</span><br><span class="line">mov cx, 160</span><br><span class="line">rep movsb</span><br><span class="line">pop cx</span><br><span class="line">loop s4</span><br><span class="line"></span><br><span class="line">mov cx, 80</span><br><span class="line">mov si, 0</span><br><span class="line">s41:</span><br><span class="line">mov byte ptr [160*24+si], &#x27; &#x27;</span><br><span class="line">add si ,2</span><br><span class="line">loop s41</span><br><span class="line">pop di</span><br><span class="line">pop si</span><br><span class="line">pop es</span><br><span class="line">pop ds</span><br><span class="line">pop cx</span><br><span class="line">pop bx</span><br><span class="line">pop ax</span><br><span class="line">ret</span><br><span class="line"></span><br><span class="line">int7ched:</span><br><span class="line">nop</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ah,1 ; 0 2 3</span><br><span class="line">mov al,2</span><br><span class="line">int 7CH</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure></p>
<ol>
<li>运行结果</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675411618416-c6c100a2-f4d1-4bc9-b3e6-22f83fcdcaee.png" alt="image.png"><br><a name="IRx7s"></a></p>
<h1 id="实验17-编写包含多个功能子程序的中断例程"><a href="#实验17-编写包含多个功能子程序的中断例程" class="headerlink" title="实验17 编写包含多个功能子程序的中断例程"></a>实验17 编写包含多个功能子程序的中断例程</h1><p>第17章实验用BIOS提供的功能号分别为2, 3的中断例程int 13H实现对软盘扇区的读写，由于该实验大多是对mul，div的用法和中断例程安装程序的复习，且无法看见实验效果，所以就没做了<br><a name="upigZ"></a></p>
<h2 id="练习17-1"><a href="#练习17-1" class="headerlink" title="练习17-1"></a>练习17-1</h2><p>接受用户的键盘输入，输入”r”，”g”,“b”分别将屏幕上的字符设置为红色，绿色，蓝色</p>
<ol>
<li>编写源程序</li>
</ol>
<p>用功能号为0的int 16H中断例程读取键盘输入即可<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line"></span><br><span class="line">show:</span><br><span class="line">push ax</span><br><span class="line">push es</span><br><span class="line">push di</span><br><span class="line"></span><br><span class="line">mov ah, 0</span><br><span class="line">int 16H</span><br><span class="line"></span><br><span class="line">mov bl, 1</span><br><span class="line">cmp al,&#x27;b&#x27;</span><br><span class="line">je showst</span><br><span class="line">shl bl, 1</span><br><span class="line">cmp al, &#x27;g&#x27;</span><br><span class="line">je showst</span><br><span class="line">shl bl, 1</span><br><span class="line">cmp al, &#x27;r&#x27;</span><br><span class="line">je showst</span><br><span class="line">jmp short FRet</span><br><span class="line"></span><br><span class="line">showst:</span><br><span class="line">mov ax, 0B800H</span><br><span class="line">mov es, ax</span><br><span class="line">mov di, 1</span><br><span class="line">mov cx, 2000</span><br><span class="line">s:</span><br><span class="line">and byte ptr es:[di], 11111000B</span><br><span class="line">or es:[di], bl</span><br><span class="line">add di, 2</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">FRet:</span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure></p>
<ol>
<li>运行结果</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675431818731-db0edf92-bc54-4bfc-a35f-613c796dddda.png" alt="image.png"><br><a name="Wyllk"></a></p>
<h1 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h1><p><a name="QMCD1"></a></p>
<h2 id="1-理解assume伪指令的作用"><a href="#1-理解assume伪指令的作用" class="headerlink" title="1. 理解assume伪指令的作用"></a>1. 理解assume伪指令的作用</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code, ds:data</span><br><span class="line">data segment</span><br><span class="line">a db 1,2,3,4,5,6,7,8</span><br><span class="line">b dw 0</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, data</span><br><span class="line">mov ds, ax</span><br><span class="line"></span><br><span class="line">mov si, 0</span><br><span class="line">mov cx, 8</span><br><span class="line"></span><br><span class="line">s:</span><br><span class="line">mov ah, 0</span><br><span class="line">mov al, a[si]</span><br><span class="line">add b, ax</span><br><span class="line">inc si</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
<ol>
<li><code>assume ds:data ss:stack</code></li>
</ol>
<ul>
<li>assume是伪指令，不会被编译为机器指令，因此实际程序运行后，段寄存器$DS、SS$中不会存放data和stack的地址，要更改段寄存器的内容需要在程序中用指令实现:<code>mov ax, data ``mov ds, ax</code></li>
<li>assume是伪指令，用于指示编译器将$DS、SS$分别与data段和stack段关联。①关联是什么意思呢？就是<strong>在编译时默认data段中的数据标号a、b的段地址在</strong>$DS$<strong>中</strong>，因此如果要正确访问到a、b的内容，必须用指令将data填入$DS$中。②数据标号自身就有段地址和偏移地址为什么还需要一个默认的段寄存器呢？这说明在程序段中的数据标号，仅含有偏移地址信息，它的段地址信息需要从默认段寄存器中取得。③此外，定义段的段标号data也不指代完整的地址，而仅仅代表段地址，因此<code>mov ax, data</code>在编译器看来是<code>mov ax, data段段地址</code>，如果data是指代一个32bits的完整地址，那么它将不能赋值给16bits的ax</li>
</ul>
<p>如果在程序中省略<code>assume ds:data</code>，则会出现_不能用段寄存器寻址_的错误<br><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675343108877-68cf68d3-97ef-4ecb-8b4f-6da330149c94.png" alt="image.png"></p>
<ol>
<li><code>assume cs:codesg</code></li>
</ol>
<p>将$CS$与代码段关联，在程序加载时将代码段(codesg)的段地址放入$CS$中. 如果去掉该语句，则程序编译不通过，因为$CS$的值不确定<br><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675341791119-4c9029f0-b9e3-4e2f-b1b9-aa5d02685f8f.png" alt="image.png"><br><a name="wwfwW"></a></p>
<h2 id="2-理解数据标号"><a href="#2-理解数据标号" class="headerlink" title="2. 理解数据标号"></a>2. 理解数据标号</h2><ol>
<li>数据标号与地址标号的不同</li>
</ol>
<p>地址标号仅指代了一个地址，而数据标号不仅指代一个地址，还指代了这个地址的数据单元长度(byte, word, double word)，进而我们可以说数据标号就代表一个内存单元（由地址和单元长度就足以确定一个单元）<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code, es:data</span><br><span class="line">data segment</span><br><span class="line">a db 1,2,3,4,5,6,7,8</span><br><span class="line">b dw 0</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, data</span><br><span class="line">mov es, ax</span><br><span class="line"></span><br><span class="line">mov si, 0</span><br><span class="line">mov cx, 8</span><br><span class="line"></span><br><span class="line">s:</span><br><span class="line">mov ah, 0</span><br><span class="line">mov al, a[si]</span><br><span class="line">add b, ax</span><br><span class="line">inc si</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure><br>这里的a和b分别指代了</p>
<ul>
<li><strong>地址为</strong><code>**seg data:0**</code><strong>, 长度为byte的字节单元</strong></li>
<li><strong>地址为</strong><code>**seg data:8**</code><strong>, 长度为word的字单元</strong></li>
</ul>
<ol>
<li>如何用数据标号以简洁形式访问内存中的数据</li>
</ol>
<p>在上一个程序中，我们用<code>mov al, a[si]</code> <code>add b, ax</code>访问了data段的内容，在编译器看来，这两条语句是这样的: <code>mov al, es:0[si]``add es:[8], ax</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675409971871-70ff728a-fa74-48ac-a742-be8ec319d677.png" alt="image.png"></p>
<ol>
<li>将标号当作数据定义<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code, ds:data</span><br><span class="line">data segment</span><br><span class="line">a db 1,2,3,4,5,6,7,8</span><br><span class="line">b dw 0</span><br><span class="line">c dw a, b</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">mov ax, data</span><br><span class="line">mov ds, ax</span><br><span class="line"></span><br><span class="line">mov dx, 2</span><br><span class="line">mov dx, c</span><br><span class="line">mov ax, c[1]</span><br><span class="line"></span><br><span class="line">mov ax, 4C00H</span><br><span class="line">int 21H</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
<code>c dw a, b</code>将数据标号当作数据定义，c指代地址为<code>seg data:000A</code>的字单元，<strong>该字单元的内容是a的偏移地址</strong>$0000$，下面是验证<br><img src="https://cdn.nlark.com/yuque/0/2023/png/29536731/1675409382345-20e1a2f2-8973-4150-992a-2a8acb141fa9.png" alt="image.png"></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.jpg" alt="Elite-X WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay.jpg" alt="Elite-X Alipay">
        <span>Alipay</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Elite-X
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="http://example.com/2023/03/06/assemble/" title="assembly language">http://example.com/2023/03/06/assemble/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/03/06/csapp-lab/" rel="prev" title="[csapp] datalab, bomblab, attacklab">
                  <i class="fa fa-chevron-left"></i> [csapp] datalab, bomblab, attacklab
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Elite-X</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
<!--
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>
-->



    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Elite-zx" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"Elite-zx","repo":"Elite-zx.github.io","client_id":"e81d3036a2dbceba447b","client_secret":"db822a7cb4b94e9ba71151c75033f3df77e10827","admin_user":"Elite-zx","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"en","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"916963d0de2c508c8e137f157e8ea315"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
